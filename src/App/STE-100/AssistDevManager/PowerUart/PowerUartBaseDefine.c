/*
* Copyright(c)2018,成都泰盟软件有限公司
* All rights reserved.
*
* 文件名称:PowerUartBaseDefine.c
* 文件标识:
* 摘要: 主要包含通信协议的函数定义
*/

/*当前版本:1.0.0
*作者:廖建伟,修改日期:2018.05.04
*/

#include "PowerUartBaseDefine.h"

////////////////////////////////////////////////////////////////////////////////
///////////////////////////1.宏定义以及枚举/////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////////////
///////////////////////////2.全局变量的定义/////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////////////
///////////////////////////3.函数声明///////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////////////
///////////////////////////4.函数定义///////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
/*************************************************
Function:       unsigned short PowerUartCheckSum16(unsigned short initValue, unsigned short *pBuf, unsigned short destLen)
Description:    校验和
Calls:          无
Called By:     	无
Input:          initValue:校验初始值
								pBuf:校验数据地址
								destLen:校验数据长度
Output:         无
Return:         校验和
Others:
*************************************************/
unsigned short PowerUartCheckSum16(unsigned short initValue, unsigned short *pBuf, unsigned short destLen)
{
	unsigned short chksum;
	unsigned int sum = initValue;

	while(destLen > 0)
	{
		sum += *pBuf++;
		destLen -= 1;
	}
	sum = (sum >> 16) + (sum & 0xffff);
	sum += (sum >> 16);
	chksum = sum;
	
	return (chksum);
}
